__NUXT_JSONP__("/wiki/content/Yii-Yii%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW){return {data:[{},{article:{slug:ao,title:ap,layout:"page",date:ag,toc:[{id:K,depth:D,text:K},{id:L,depth:D,text:L},{id:aq,depth:D,text:ar},{id:M,depth:r,text:M},{id:N,depth:r,text:N},{id:O,depth:r,text:O},{id:as,depth:r,text:at},{id:au,depth:r,text:av},{id:P,depth:r,text:P},{id:Q,depth:r,text:Q},{id:E,depth:r,text:E},{id:R,depth:r,text:R},{id:S,depth:D,text:S},{id:aw,depth:r,text:ax},{id:T,depth:r,text:T},{id:U,depth:r,text:U},{id:F,depth:r,text:F},{id:V,depth:r,text:V},{id:W,depth:r,text:W},{id:X,depth:D,text:X},{id:Y,depth:r,text:Y},{id:Z,depth:r,text:Z},{id:_,depth:r,text:_},{id:$,depth:r,text:$},{id:aa,depth:r,text:aa},{id:ab,depth:r,text:ab},{id:ac,depth:r,text:ac},{id:G,depth:r,text:G},{id:ad,depth:r,text:ad}],body:{type:"root",children:[{type:b,tag:"blockquote",props:{},children:[{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"来自"},{type:b,tag:m,props:{href:"http:\u002F\u002Fwww.imooc.com\u002Flearn\u002F404",rel:[ah,ai,aj],target:ak},children:[{type:a,value:"与《Yii框架》不得不说的故事—基础篇"}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:H,props:{id:K},children:[{type:b,tag:m,props:{href:"#%E9%85%8D%E7%BD%AE",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:K}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"入口脚本文件: "},{type:b,tag:d,props:{},children:[{type:a,value:"config\u002Fweb.php"}]}]},{type:a,value:c},{type:b,tag:"ul",props:{},children:[{type:a,value:c},{type:b,tag:y,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:ay}]},{type:a,value:"是为了防止cookie攻击的"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$config = [\n    'id' =\u003E 'basic',\n    'basePath' =\u003E dirname(__DIR__),\n    'bootstrap' =\u003E ['log'],\n    'components' =\u003E [\n        'request' =\u003E [\n            \u002F\u002F用来防止cook攻击的\n            \u002F\u002F !!! insert a secret key in the following (if it is empty) - this is required by cookie validation\n            'cookieValidationKey' =\u003E '_FEdiSEYNINKhO2Pt8JCp33PkGvB4wBj',\n        ],\n        ....\n"}]}]}]},{type:a,value:c},{type:b,tag:H,props:{id:L},children:[{type:b,tag:m,props:{href:"#%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:L}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"2017090722293application-structure.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F2017090722293application-structure.png"},children:[]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"(图片来自:"},{type:b,tag:m,props:{href:az,rel:[ah,ai,aj],target:ak},children:[{type:a,value:az}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"请求交给了应用主体 -\u003E 应用主体处理请求之前会加载应用组件、以及相应的模块来更好的处理请求 -\u003E 正式处理请求时会把请求的数据委托给控制器 -\u003E 控制器通过"},{type:b,tag:d,props:{},children:[{type:a,value:"模型"}]},{type:a,value:"来和数据库打交道 -\u003E 需要展示的话会让视图去进行相应操作"}]},{type:a,value:c},{type:b,tag:H,props:{id:aq},children:[{type:b,tag:m,props:{href:"#%E6%8E%A7%E5%88%B6%E5%99%A8controller%E5%88%9B%E5%BB%BA",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:ar}]},{type:a,value:c},{type:b,tag:s,props:{id:M},children:[{type:b,tag:m,props:{href:"#%E5%88%9B%E5%BB%BA",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:M}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"新建一个"},{type:b,tag:d,props:{},children:[{type:a,value:"HelloController.php"}]},{type:a,value:",放到controller目录下。"}]},{type:a,value:c},{type:b,tag:al,props:{},children:[{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"需要使用命名空间"},{type:b,tag:d,props:{},children:[{type:a,value:"namespace app\\controllers;"}]}]},{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"需要继承自"},{type:b,tag:d,props:{},children:[{type:a,value:"Controller"}]},{type:a,value:",因此需要"},{type:b,tag:d,props:{},children:[{type:a,value:"use yii\\web\\Controller;"}]}]},{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"不需要"},{type:b,tag:d,props:{},children:[{type:a,value:"include"}]},{type:a,value:"也可以使用外部对象,因为"},{type:b,tag:d,props:{},children:[{type:a,value:"composer"}]},{type:a,value:"帮我们做了这一操作,具体见"},{type:b,tag:d,props:{},children:[{type:a,value:"composer.json"}]},{type:a,value:"的配置"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\nnamespace app\\controllers; \u002F\u002F必须使用命名空间app\\controller\nuse yii\\web\\Controller; \u002F\u002FxxController继承于`controller`\nclass HelloController extends Controller\n{\n    \u002F\u002F http:\u002F\u002Flocalhost\u002FYii\u002Fbasic\u002Fweb\u002F?r=hello\u002Findex\n    public function actionIndex(){\n        echo 'hello world';\n    }\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"访问"},{type:b,tag:d,props:{},children:[{type:a,value:"http:\u002F\u002Flocalhost\u002FYii\u002Fbasic\u002Fweb\u002F?r=hello\u002Findex"}]},{type:a,value:"或"},{type:b,tag:d,props:{},children:[{type:a,value:"http:\u002F\u002Flocalhost\u002FYii\u002Fbasic\u002Fweb\u002F?r=hello"}]},{type:a,value:"就可以看到'hello world'了。 (访问路径以自己实际配置的为准)"}]},{type:a,value:c},{type:b,tag:s,props:{id:N},children:[{type:b,tag:m,props:{href:"#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%AD%89",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:N}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"需要用到全局类"},{type:b,tag:d,props:{},children:[{type:a,value:aA}]},{type:a,value:ae},{type:b,tag:d,props:{},children:[{type:a,value:"$app"}]},{type:a,value:"为全局变量。可以使用``use Yii;"},{type:b,tag:d,props:{},children:[{type:a,value:"或者"}]},{type:a,value:"\\Yii::$App`"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"    public function actionIndex(){\n\n        \u002F\u002F请求组件:\n        \u002F\u002FYii为全局类。 $app为全局变量  可以`use Yii;`或者 `\\Yii:$app`\n        \u002F\u002Fhttp:\u002F\u002Flocalhost\u002FYii\u002Fbasic\u002Fweb\u002F?r=hello\u002Findex&id=3\n        \u002F\u002Fhttp:\u002F\u002Flocalhost\u002FYii\u002Fbasic\u002Fweb\u002F?r=hello\u002Findex&id=999\n        \u002F\u002F如何处理参数\n        $request = Yii::$app -\u003E request;\n        echo $request -\u003E get('id');\n        \u002F\u002F默认值为20,如果没有id参数的话\n        echo $request -\u003E get('id',20);\n\n        \u002F\u002F类似的\n        \u002F\u002Fpost\n        \u002F\u002F$request -\u003E post('name',3333);\n\n        \u002F\u002F判断是get还是其他\n        if ($request -\u003E isGet){\n            echo '\u003Cbr\u003E是get请求';\n        }\n        \u002F\u002F获取ip地址\n        echo $request -\u003E userIP;\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:O},children:[{type:b,tag:m,props:{href:"#%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:O}]},{type:a,value:c},{type:b,tag:s,props:{id:as},children:[{type:b,tag:m,props:{href:"#%E8%BF%94%E5%9B%9E%E7%8A%B6%E6%80%81%E7%A0%81",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:at}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"public function actionIndex2(){\n   \u002F\u002Fresponse组件\n   $res = Yii::$app -\u003E response;\n   \u002F\u002F设置返回码,如返回404\n   $res -\u003E statusCode = 404;\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:au},children:[{type:b,tag:m,props:{href:"#%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%A4%B4",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:av}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"    public function actionIndex2(){\n        \u002F\u002Fresponse组件\n        $res = Yii::$app -\u003E response;\n        $res -\u003E headers -\u003E add('pragma','no-cache');\n\u002F\u002F        $res -\u003E headers -\u003E set('pragma','max-age=5');\n\u002F\u002F        $res -\u003E headers -\u003E remove('pragma');\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"201709123287011.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F201709123287011.png"},children:[]}]},{type:a,value:c},{type:b,tag:s,props:{id:P},children:[{type:b,tag:m,props:{href:"#%E9%87%8D%E5%AE%9A%E5%90%91",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:P}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"   public function actionIndex2(){\n        \u002F\u002Fresponse组件\n        $res = Yii::$app -\u003E response;\n          \u002F\u002F$res -\u003E headers -\u003E add('Location','http:\u002F\u002Fwww.baidu.com');\n         \u002F\u002Fyi controller 封装了redirect方法\n        \u002F\u002F$this -\u003E redirect('https:\u002F\u002Fbaidu.com');\n        $this -\u003E redirect('https:\u002F\u002Fbaidu.com',302);\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:Q},children:[{type:b,tag:m,props:{href:"#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:Q}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"public function actionIndex2(){\n        \u002F\u002Fresponse组件\n        $res = Yii::$app -\u003E response;\n        \u002F\u002F文件下载\n        \u002F\u002F这样会下载一个 a.png的文件。 但是是空的，因为没有配置\n        \u002F\u002F$res -\u003E headers -\u003E add('content-disposition','attachment;filename=\"a.png\"');\n        \u002F\u002Fyi controller 封装了方法 ,但是如果没有文件会抛出异常\n        $res -\u003E sendFile('.\u002Fb.jpg');\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$res -\u003E sendFile('.\u002Fb.jpg');"}]},{type:a,value:"中,如果找不到路径下的文件就会抛出异常:"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"2017091284652error.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F2017091284652error.png"},children:[]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"此处文件路径位置是相对于入口脚本("},{type:b,tag:d,props:{},children:[{type:a,value:"web\u002Findex,php"}]},{type:a,value:")的路径."}]},{type:a,value:c},{type:b,tag:s,props:{id:E},children:[{type:b,tag:m,props:{href:"#session",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:E}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:aB},{type:b,tag:d,props:{},children:[{type:a,value:E}]},{type:a,value:"组件： "},{type:b,tag:d,props:{},children:[{type:a,value:"$session = Yii::$app-\u003Esession"}]},{type:a,value:"."}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"判断是否开启: "},{type:b,tag:d,props:{},children:[{type:a,value:"$session -\u003E isActive"}]}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"    public  function  actionIndex3(){\n\n        $session = Yii::$app -\u003E session;\n\n        \u002F\u002F打开\n        $session -\u003E open();\n\n        if ($session-\u003EisActive){\n            echo 'isActive';\n        }else{\n            echo 'not Active';\n        }\n\n        \u002F\u002F这样可以存放数据了\n        \u002F\u002F存放位置在php.ini中的session.save_path可以找到\n        $session -\u003E set('user','张三');\n\n        echo $session-\u003Eget('user');\n\n        \u002F\u002F删除\n        $session -\u003E remove('user');\n        echo $session-\u003Eget('user').'\u003C\u002Fbr\u003E';\n        \n        \u002F\u002F其他操作,可以当成数组处理。原因是继承了ArrayAccess\n        $session['user']  = '小明';\n        echo $session-\u003Eget('user').'\u003C\u002Fbr\u003E';\n        \u002F\u002F删除\n        unset($session['user']);\n        echo $session-\u003Eget('user').'\u003C\u002Fbr\u003E';\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"存储的sessionId可以在这里看到. 本地session目录下的文件也是根据sessionId的值存储的。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002FsessionId.png"},children:[]}]},{type:a,value:c},{type:b,tag:s,props:{id:R},children:[{type:b,tag:m,props:{href:"#cookie",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:R}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"2017091433783cookie.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F2017091433783cookie.png"},children:[]}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"public function  actionIndex4(){\n   $cookies = Yii::$app -\u003E response -\u003Ecookies;\n   \u002F\u002F从浏览器可以看到，cookie的值是加密的\n   $cookiesData = array('name' =\u003E 'user' , 'value' =\u003E 'zhangsan3');\n   $cookies -\u003E add( new Cookie($cookiesData));\n   \u002F\u002F删除某个cookie\n   \u002F\u002F$cookies -\u003E remove('user');\n   \u002F\u002F取某个cookie值\n   echo $cookies -\u003E getValue('user');\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"cookie如何加密,与"},{type:b,tag:d,props:{},children:[{type:a,value:"onfig\u002Fweb.php"}]},{type:a,value:"中的"},{type:b,tag:d,props:{},children:[{type:a,value:ay}]},{type:a,value:"有关。"}]},{type:a,value:c},{type:b,tag:H,props:{id:S},children:[{type:b,tag:m,props:{href:"#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%88%9B%E5%BB%BA",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:S}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"Yii允许把代码移动到view中来编写。"}]},{type:a,value:c},{type:b,tag:s,props:{id:aw},children:[{type:b,tag:m,props:{href:"#renderpartial",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:ax}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002FHelloController.php文件\n.... \nfunction  actionIndex(){\n   \u002F\u002FactionIndex和视图index.php对应\n   \u002F\u002F视图的index.php需要放到`Views\u002FHello`目录下,目录名称与`Hello`Controller保持一致\n   \u002F\u002F显示哪个view文件\n   return $this-\u003ErenderPartial('index');\n}\n...\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:T},children:[{type:b,tag:m,props:{href:"#%E4%BC%A0%E9%80%92%E5%AD%97%E5%85%B8%E6%88%96%E6%95%B0%E7%BB%84%E5%8F%82%E6%95%B0",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:T}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"HelloController.php文件:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"function  actionIndex(){\n   $data = array();\n   $data['view_hello_str'] =  'Hello God!';\n   \u002F\u002F数组元素的情况,如何读取\n   $data['view_test_arr'] =  array(1,2);\n   \u002F\u002F传参数\n   return $this -\u003E renderPartial('index',$data);\n   \u002F\u002F也可以用render，这样话会保留网站的header footer ，而不是一个新界面\n   \u002F\u002Freturn $this -\u003Erender('index',$data);\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"对应的视图文件"},{type:b,tag:d,props:{},children:[{type:a,value:"views\u002FHello\u002Findex.php"}]},{type:a,value:af}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\necho $view_hello_str; \u002F\u002F浏览器会显示`Hello God`\necho  '\u003C\u002Fbr\u003E';\necho $view_test_arr[0] ; \u002F\u002F显示 `1`\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:U},children:[{type:b,tag:m,props:{href:"#%E8%A7%86%E5%9B%BE%E7%9A%84%E6%95%B0%E7%BB%84%E5%AE%89%E5%85%A8",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:U}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:aC}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"    function  actionIndex(){\n        $data = array();\n        $data['view_hello_str'] =  'Hello God! \u003Cscript\u003E alert(\"hello world\") \u003C\u002Fscript\u003E';\n        return $this -\u003E renderPartial('index',$data);\n    }\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"这样会导致执行javascript代码,如果字符串是用户传过来的，可能会导致安全问题。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"处理方法:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\nuse yii\\helpers\\Html;\nuse yii\\helpers\\HtmlPurifier;\n?\u003E\n\u003Ch1\u003E \u003C?=html::encode($view_hello_str)?\u003E  \u003C\u002Fh1\u003E \u002F\u002F会输出正常字符串:Hello God! \u003Cscript\u003E alert(\"hello world\") \u003C\u002Fscript\u003E\n\u003Ch1\u003E \u003C?=HtmlPurifier::process($view_hello_str)?\u003E  \u003C\u002Fh1\u003E \u002F\u002F输出`Hello God!`\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:F},children:[{type:b,tag:m,props:{href:"#%E5%B8%83%E5%B1%80%E6%96%87%E4%BB%B6",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:F}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"使用布局文件可以使我们少些很多重复代码。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:aB},{type:b,tag:d,props:{},children:[{type:a,value:"render"}]},{type:a,value:"方法:\nrender做两件事："}]},{type:a,value:c},{type:b,tag:al,props:{},children:[{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"将about.php的内容放到"},{type:b,tag:d,props:{},children:[{type:a,value:"$content"}]},{type:a,value:"文件中"}]},{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"render方法把布局文件显示出来,布局文件通过"},{type:b,tag:d,props:{},children:[{type:a,value:"public  $layout = 'common';"}]},{type:a,value:"来指定"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"默认布局文件位置:"},{type:b,tag:d,props:{},children:[{type:a,value:"views\u002Flayouts\u002Fmain.php"}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"创建一个布局文件: "},{type:b,tag:d,props:{},children:[{type:a,value:"view\u002Flayouts\u002Fcommon.php"}]}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C!DOCTYPE html\u003E\n\u003Chtml\u003E\n\u003Chead\u003E\n    \u003Cmeta charset=\"utf-8\" \u002F\u003E\n    \u003Ctitle\u003E\u003C\u002Ftitle\u003E\n    \u003Cscript src=\"https:\u002F\u002Fcdn.bootcss.com\u002Freact\u002F15.4.2\u002Freact.min.js\"\u003E\u003C\u002Fscript\u003E\n    \u003Cscript src=\"https:\u002F\u002Fcdn.bootcss.com\u002Freact\u002F15.4.2\u002Freact-dom.min.js\"\u003E\u003C\u002Fscript\u003E\n    \u003Cscript src=\"https:\u002F\u002Fcdn.bootcss.com\u002Fbabel-standalone\u002F6.22.1\u002Fbabel.min.js\"\u003E\u003C\u002Fscript\u003E\n\u003C\u002Fhead\u003E\n\u003Cbody\u003E\n    \u003C?=$content;?\u003E\n\u003C\u002Fbody\u003E\n\u003C\u002Fhtml\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"controller:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"...\npublic  $layout = 'common';\npublic function actionAbout()\n{\n   \u002F\u002Frender做两件事\n   \u002F\u002F1.将about.php的内容放到`$content`文件中\n   \u002F\u002F2.render方法把布局文件`common`显示出来,布局文件通过`public  $layout = 'common';`来指定\n   return $this-\u003Erender('about');\n}\n...\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"视图文件"},{type:b,tag:d,props:{},children:[{type:a,value:"view2\u002FHello\u002Findex.php"}]},{type:a,value:af}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003Ch2\u003E about page\u003C\u002Fh2\u003E\n\u003Cdiv id=\"example\"\u003E\u003C\u002Fdiv\u003E\n\u003Cscript type=\"text\u002Fbabel\"\u003E\n    ReactDOM.render(\n        \u003Ch1\u003EHello, world!\u003C\u002Fh1\u003E,\n        document.getElementById('example')\n    );\n\u003C\u002Fscript\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:V},children:[{type:b,tag:m,props:{href:"#%E8%A7%86%E5%9B%BE%E4%B8%AD%E6%98%BE%E7%A4%BA%E5%85%B6%E4%BB%96%E8%A7%86%E5%9B%BE%EF%BC%88%E8%A7%86%E5%9B%BE%E7%BB%84%E4%BB%B6%EF%BC%89",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:V}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"以视图:"},{type:b,tag:d,props:{},children:[{type:a,value:"index.php"}]},{type:a,value:"为例:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C!--引入其他视图--\u003E\n\u003C?php echo $this -\u003E render('about'); ?\u003E\n\n\u003C!--传参数--\u003E\n\u003C?php echo $this -\u003E render('about',array('v_hello_str' =\u003E 'hello world')); ?\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"view: "},{type:b,tag:d,props:{},children:[{type:a,value:"about.php"}]}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003Ch2\u003E this is  about page\u003C\u002Fh2\u003E\n\u003C?php\nif (isset($v_hello_str)){\n    echo  $v_hello_str;\n}\n?\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"浏览器输出结果:"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"2017091712648out.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F2017091712648out.png"},children:[]}]},{type:a,value:c},{type:b,tag:s,props:{id:W},children:[{type:b,tag:m,props:{href:"#%E8%A7%86%E5%9B%BE%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%9D%97",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:W}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"指的是"},{type:b,tag:d,props:{},children:[{type:a,value:"layout"}]},{type:a,value:aD},{type:b,tag:d,props:{},children:[{type:a,value:"view"}]},{type:a,value:"文件的代码块。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:"strong",props:{},children:[{type:a,value:aC}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"controller指定了布局文件为"},{type:b,tag:d,props:{},children:[{type:a,value:aE}]}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"...\npublic  $layout = 'common';\npublic function actionAbout()\n{\n   return $this-\u003Erender('about');\n}\n...\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"view\u002FHello\u002Fabout.php"}]},{type:a,value:"文件:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003Ch1\u003E this is about page\u003C\u002Fh1\u003E\n\u003C?php $this -\u003E beginBlock('block1');?\u003E\n\u003Ch2\u003E 这是被替换掉的部分\u003C\u002Fh2\u003E\n\u003C?php $this -\u003E endBlock(); ?\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:F},{type:b,tag:d,props:{},children:[{type:a,value:aE}]},{type:a,value:",使用"},{type:b,tag:d,props:{},children:[{type:a,value:aF}]},{type:a,value:"可以将视图文件的block部分替换掉。"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C!DOCTYPE html\u003E\n\u003Chtml\u003E\n\u003Chead\u003E\n    \u003Cmeta charset=\"utf-8\" \u002F\u003E\n    \u003Ctitle\u003E\u003C\u002Ftitle\u003E\n\u003C\u002Fhead\u003E\n\u003Cbody\u003E\n    \u003C?=$this-\u003Eblocks['block1'];?\u003E\n    \u003C?=$content;?\u003E\n\u003C\u002Fbody\u003E\n\u003C\u002Fhtml\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:b,tag:A,props:{alt:"20170918417351.png",src:"https:\u002F\u002Fcdn.jsdelivr.net\u002Fgh\u002Fquicktouch\u002Fimage@main\u002Fimg\u002F20170918417351.png"},children:[]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"需要注意的是:"}]},{type:a,value:c},{type:b,tag:al,props:{},children:[{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"如果布局文件没有指定"},{type:b,tag:d,props:{},children:[{type:a,value:aF}]},{type:a,value:",浏览器就不会显示block块里的内容；"}]},{type:a,value:c},{type:b,tag:y,props:{},children:[{type:a,value:"同样的,如果view文件没有指定"},{type:b,tag:d,props:{},children:[{type:a,value:"beginBlock.."}]},{type:a,value:",浏览器就不会显示block块里的内容。"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"布局文件可以通过"},{type:b,tag:d,props:{},children:[{type:a,value:"isset"}]},{type:a,value:"判断是否view文件是否包含相应的代码块:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C!DOCTYPE html\u003E\n\u003Chtml\u003E\n\u003Chead\u003E\n    \u003Cmeta charset=\"utf-8\" \u002F\u003E\n    \u003Ctitle\u003E\u003C\u002Ftitle\u003E\n\u003C\u002Fhead\u003E\n\u003Cbody\u003E\n    \u003C?php if (isset($this-\u003Eblocks['block1'])):?\u003E\n        \u003C?=$this-\u003Eblocks['block1'];?\u003E\n    \u003C?php else:?\u003E\n        \u003Ch1\u003E没有block1代码块\u003C\u002Fh1\u003E\n    \u003C?php endif;?\u003E\n    \u003C?=$content;?\u003E\n\u003C\u002Fbody\u003E\n\u003C\u002Fhtml\u003E\n"}]}]}]},{type:a,value:c},{type:b,tag:H,props:{id:X},children:[{type:b,tag:m,props:{href:"#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:X}]},{type:a,value:c},{type:b,tag:s,props:{id:Y},children:[{type:b,tag:m,props:{href:"#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:Y}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"创建数据库并插入一条数据:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,aG]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"mysql"},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:aH}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:aI}]},{type:a,value:aJ},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:I}]},{type:a,value:aK},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:ae}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,J]},children:[{type:a,value:aL}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:aM}]},{type:a,value:aN},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:b,tag:e,props:{className:[g,J]},children:[{type:a,value:"0.01"}]},{type:a,value:aO},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:a,value:"\nmysql"},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"use"}]},{type:a,value:aJ},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:I}]},{type:a,value:c},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"Database"}]},{type:a,value:" changed\nmysql"},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:"  "},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:aH}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"table"}]},{type:a,value:" test2 "},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:a,value:am},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:an}]},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:" id "},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"int"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"auto_increment"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"primary"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"key"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:ae}]},{type:a,value:am},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:an}]},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:"  title "},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"varchar"}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:b,tag:e,props:{className:[g,J]},children:[{type:a,value:"20"}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:a,value:am},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:an}]},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"CHARSET"}]},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:aP}]},{type:a,value:"utf8"},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:I}]},{type:a,value:"\n    \nmysql"},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:z}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"insert"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"into"}]},{type:a,value:" test2"},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:a,value:"title"},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"values"}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:b,tag:e,props:{className:[g,aQ]},children:[{type:a,value:"'小明'"}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:I}]},{type:a,value:aK},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:ae}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,J]},children:[{type:a,value:aL}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:aM}]},{type:a,value:aN},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:C}]},{type:b,tag:e,props:{className:[g,J]},children:[{type:a,value:"0.00"}]},{type:a,value:aO},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:B}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"数据库配置文件为"},{type:b,tag:d,props:{},children:[{type:a,value:"config\u002Fdb.php"}]},{type:a,value:af}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\n\nreturn [\n    'class' =\u003E 'yii\\db\\Connection',\n    'dsn' =\u003E 'mysql:host=127.0.0.1;dbname=yii',\n    'username' =\u003E 'root',\n    'password' =\u003E '123',\n    'charset' =\u003E 'utf8',\n];\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:Z},children:[{type:b,tag:m,props:{href:"#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E4%B9%8B%E6%B4%BB%E5%8A%A8%E8%AE%B0%E5%BD%95%E7%9A%84%E5%88%9B%E5%BB%BA",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:Z}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"新建"},{type:b,tag:d,props:{},children:[{type:a,value:"models\u002Ftest2.php"}]},{type:a,value:"文件,与数据库表名相对应。"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\nnamespace app\\models;\nuse yii\\db\\ActiveRecord;\n\n\u002F\u002F继承于`ActiveRecord`\nclass Test2 extends ActiveRecord\n{\n    \u002F\u002F如果要修改表名,重写这个方法\n    public static function tableName()\n    {\n        return parent::tableName(); \u002F\u002F TODO: Change the autogenerated stub\n    }\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"操作数据库表:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"...\nuse app\\models\\Test2;\n...\nclass HelloController extends Controller\n{\n\n    public function  actionIndex(){\n\n        $sql = 'select * from test2 where id = 1 && 1=1';\n        $result =  Test2::findBySql($sql) -\u003E all();\n        print_r($result);\n    }\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:_},children:[{type:b,tag:m,props:{href:"#%E9%98%B2%E6%AD%A2sql%E6%B3%A8%E5%85%A5",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:_}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"如果用字符串拼接sql,可能会有问题,例如:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,aG]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$"},{type:b,tag:e,props:{className:[g,v]},children:[{type:a,value:"sql"}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,w]},children:[{type:a,value:aP}]},{type:a,value:u},{type:b,tag:e,props:{className:[g,aQ]},children:[{type:a,value:"'select * from test2 where id = 1 || 1 = 1'"}]},{type:b,tag:e,props:{className:[g,t]},children:[{type:a,value:I}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"提供占位符的形式:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$sql = 'select * from test2 where id = :id';\n$result =  Test2::findBySql($sql,array(':id' =\u003E 1 )) -\u003E all();\nprint_r($result);\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"运行时会将占位符看成一个整体。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"此外提供了更优雅的方式:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result =  Test2::find()-\u003Ewhere(['id' =\u003E 2]) -\u003E all();\nprint_r($result);\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:z}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result =  Test2::find()-\u003Ewhere(['\u003E','id', '1']) -\u003E all();\nprint_r($result);\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"between"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result =  Test2::find()-\u003Ewhere(['between','id', 1,2]) -\u003E all();\nprint_r($result);\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"like"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result =  Test2::find()-\u003Ewhere(['like','title',\"小明\"]) -\u003E all();\nprint_r($result);\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:$},children:[{type:b,tag:m,props:{href:"#%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:$}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"将查询结果(对象)转换为数组:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result =  Test2::find()-\u003Ewhere(['like','title',\"小明\"])-\u003E asArray() -\u003E all();\nprint_r($result);\n\n\u002F\u002F查询结果\nArray\n(\n    [0] =\u003E Array\n        (\n            [id] =\u003E 1\n            [title] =\u003E 小明\n        )\n)\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"批量查询: 分批"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002F配合foreach\nforeach (Test2::find() -\u003E batch(1) as $tests){\n  print_r($tests);\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:aa},children:[{type:b,tag:m,props:{href:"#%E5%88%A0%E9%99%A4",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:aa}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"删除一条:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$result = Test2::find() -\u003E where(['id' =\u003E 1]) -\u003E all();\n$result[0] -\u003E delete();\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"删除多条:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Test2::deleteAll('id\u003E:id',array(':id'=\u003E0));\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:ab},children:[{type:b,tag:m,props:{href:"#%E6%B7%BB%E5%8A%A0",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:ab}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:aD},{type:b,tag:d,props:{},children:[{type:a,value:"save()"}]},{type:a,value:"方法:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002F添加数据\n$test = new Test2();\n$test -\u003E title = \"小黑\";\n$test -\u003E save();\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"model中的验证举例:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"public  function rules()\n{\n   return [\n       ['title','string','length'=\u003E [0,5]]\n   ];\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"进行验证:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002F添加数据\n$test = new Test2();\n$test -\u003E title = \"小黑小黑小黑\";\n\n$test -\u003E validate();\nif ($test -\u003E hasErrors()){\n  echo 'data is error';\n  die;\n}\n$test -\u003E save();\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:ac},children:[{type:b,tag:m,props:{href:"#%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:ac}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"修改,然后使用save保存"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$test = Test2::find()-\u003Ewhere(['id' =\u003E 4]) -\u003E one();\n$test-\u003Etitle = 't4';\n$test-\u003Esave();\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:G},children:[{type:b,tag:m,props:{href:"#%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:G}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"测试数据:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"mysql\u003E create table customer ( \n    -\u003E id int auto_increment primary key ,\n    -\u003E name varchar(20)\n    -\u003E ) CHARSET=utf8;    \nmysql\u003E create table myorder( id int auto_increment primary key , customer_id int , price int);\nQuery OK, 0 rows affected (0.01 sec) \n\nmysql\u003E select * from customer;\n+----+--------+\n| id | name   |\n+----+--------+\n|  1 | 小明   |\n|  2 | 小白   |\n+----+--------+\n2 rows in set (0.00 sec)\n\nmysql\u003E insert into myorder(customer_id,price) values('1', 20);\nQuery OK, 1 row affected (0.01 sec)\n\nmysql\u003E insert into myorder(customer_id,price) values('2', 120);\nQuery OK, 1 row affected (0.00 sec)\n\nmysql\u003E select * from myorder;\n+----+-------------+-------+\n| id | customer_id | price |\n+----+-------------+-------+\n|  1 |           1 |    20 |\n|  2 |           2 |   120 |\n+----+-------------+-------+\n2 rows in set (0.00 sec)   \n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"order模型:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"namespace app\\models;\nuse yii\\db\\ActiveRecord;\nclass Order extends ActiveRecord\n{\n    public static function tableName()\n    {\n        return \"myorder\";\n    }\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:G}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002F关联查询  根据顾客查询订单信息\n$customer = Customer::find()-\u003Ewhere(['name' =\u003E '小明']) -\u003E one();\n\u002F\u002F关联查询的方法\n$order = $customer-\u003EhasMany('app\\models\\Order',['customer_id' =\u003E 'id']) -\u003E all();\nprint_r($order);\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"也可以使用静态方法获取类名:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$order = $customer-\u003EhasMany(Order::className(),['customer_id' =\u003E 'id']) -\u003E all();\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"将查询的代码封装到"},{type:b,tag:d,props:{},children:[{type:a,value:"Customer"}]},{type:a,value:"类中:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u003C?php\nnamespace app\\models;\nuse yii\\db\\ActiveRecord;\n\nclass Customer extends ActiveRecord\n{\n        \u002F\u002F顾客获取订单信息\n    public function getOrders(){\n\n        \u002F\u002F关联查询  根据顾客查询订单信息\n        \u002F\u002F$customer = Customer::find()-\u003Ewhere(['name' =\u003E '小明']) -\u003E one();\n        \u002F\u002F关联查询的方法\n        \u002F\u002F$order = $customer-\u003EhasMany('app\\models\\Order',['customer_id' =\u003E 'id']) -\u003E all();\n        $order = $this-\u003EhasMany(Order::className(),['customer_id' =\u003E 'id']) -\u003E asArray() ; \u002F\u002F-\u003Eall();\n\n        \u002F\u002Fprint_r($customer-\u003EgetOrders());\n        \u002F\u002F如果要使用\n        \u002F\u002Fprint_r($customer-\u003Eorders);\n        \u002F\u002F访问不存在的属性时,会访问`__get()`方法,自动调用get方法,自动补上-\u003Eall()方法\n        \u002F\u002F会冲突,因此去掉 -\u003E all(),使用 -\u003Eorders返回同样结果\n      return $order;\n    }\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"根据订单查询用户(hasOne查询单个):"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"namespace app\\models;\nuse yii\\db\\ActiveRecord;\n\nclass Order extends ActiveRecord\n{\n    public function  getCustomer(){\n        \u002F\u002F一个订单对应一个顾客\n        return $this -\u003E hasOne(Customer::className(),['id' =\u003E 'customer_id']);\n    }\n    public static function tableName()\n    {\n        return \"myorder\";\n    }\n}\n\n\u002F**使用\n        $order = Order::find() -\u003E where(['id' =\u003E 1]) -\u003E one();\n        $res = $order -\u003E customer;\n        print_r($res);\n*\u002F\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:ad},children:[{type:b,tag:m,props:{href:"#%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E6%B3%A8%E6%84%8F%E7%82%B9",ariaHidden:n,tabIndex:o},children:[{type:b,tag:e,props:{className:[p,q]},children:[]}]},{type:a,value:ad}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"1). 关联查询的结果缓存可以通过unset清除"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$order = Order::find() -\u003E where(['id' =\u003E 1]) -\u003E one();\n$res1 = $order -\u003E customer;\nunset($order -\u003E customer);\n$res2 = $order -\u003E customer; \u002F\u002F重新执行了 select * from ....\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"2). 关联查询的多次查询"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"\u002F\u002F查询全部用户\n$customer::find() -\u003E all();\nforeach ($customers as $customer){\n    \u002F\u002F查询每个用户的订单信息\n    $orders = $customer -\u003E orders;\n}\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"如果有100个用户会执行sql （1+100) 次。"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"优化:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,l]},children:[{type:b,tag:d,props:{},children:[{type:a,value:"$customers = Customer::find()-\u003Ewith('orders') -\u003E all();\n"}]}]}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"给用户的orders属性填上值\n执行了"},{type:b,tag:d,props:{},children:[{type:a,value:"select * from a where id in (select id from b );"}]},{type:a,value:af}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"select * from customer ;\nselect * from order where customer_id in(...)"}]},{type:a,value:c},{type:b,tag:f,props:{},children:[{type:a,value:"参考: "},{type:b,tag:m,props:{href:aR,rel:[ah,ai,aj],target:ak},children:[{type:a,value:aR}]}]}]},dir:"\u002Fwiki\u002FPHP\u002FYii",path:aS,extension:".md",createdAt:aT,updatedAt:aT},prev:{slug:"Autolayout-baseline",title:"label底部对齐、顶部对齐",date:"2017-08-19T16:10:51.000Z"},next:{slug:"适配-iOS11 Xcode9新功能新特性",title:"iOS11 Xcode9新功能新特性",date:"2017-09-20T15:20:33.000Z"},scrollTop:aU,sideCategory:[{folderName:"PHP",articles:[{slug:"PHP-Grav玩法-Header",title:"Grav玩法-Header",date:"2018-01-18T16:18:03.000Z",path:"\u002Fwiki\u002FPHP\u002FPHP-Grav玩法-Header"},{slug:"PHP-Grav玩法-安装配置",title:"Grav玩法-安装配置",date:"2018-01-19T16:18:03.000Z",path:"\u002Fwiki\u002FPHP\u002FPHP-Grav玩法-安装配置"},{slug:"PHP-PHP系统架构师成长之路",title:"PHP系统架构师成长之路",date:"2017-09-04T13:15:59.000Z",path:"\u002Fwiki\u002FPHP\u002FPHP-PHP系统架构师成长之路"}],children:[{folderName:aA,articles:[{slug:"Yii-Yii Gii工具使用",title:"Yii Gii工具使用",date:aV,path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii Gii工具使用"},{slug:"Yii-Yii 安全篇",title:"Yii 安全篇",date:aV,path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii 安全篇"},{slug:"Yii-Yii-install",title:"Yii安装",date:"2017年07月11日21:03:26",path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii-install"},{slug:"Yii-Yii-lifecycle",title:"life Cycle",date:"2017-07-16T15:53:11.000Z",path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii-lifecycle"},{slug:"Yii-Yii学习笔记(二)",title:"Yii学习笔记(二)",date:ag,path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii学习笔记(二)"},{slug:"Yii-Yii学习资料",title:"Yii学习资料",date:"2017-09-06T08:39:17.000Z",path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii学习资料"},{slug:"Yii-view-action",title:"Action、View",date:"2017-09-02T11:14:01.000Z",path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-view-action"},{slug:"Yii-yii-database",title:aI,date:"2017-09-03T17:29:38.000Z",path:"\u002Fwiki\u002FPHP\u002FYii\u002FYii-yii-database"},{slug:ao,title:ap,date:ag,path:aS}],children:[]},{folderName:"基础笔记",articles:[{slug:"基础笔记-1.PHP的标记形式 && 变量",title:"变量",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-1.PHP的标记形式 && 变量"},{slug:"基础笔记-10. 数组",title:"数组",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-10. 数组"},{slug:"基础笔记-2. 常量 ",title:"常量",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-2. 常量 "},{slug:"基础笔记-3. 基本数据类型",title:"基本数据类型",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-3. 基本数据类型"},{slug:"基础笔记-4.复合数据类型",title:"复合数据类型",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-4.复合数据类型"},{slug:"基础笔记-5. 运算符 位移运算 ",title:"运算符 位移运算",date:"2017-06-15 010:02",path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-5. 运算符 位移运算 "},{slug:"基础笔记-6. 控制脚本的执行顺序 ",title:"控制脚本的执行顺序",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-6. 控制脚本的执行顺序 "},{slug:"基础笔记-7.文件加载 ",title:"文件加载\"",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-7.文件加载 "},{slug:"基础笔记-8. 错误处理",title:"错误处理",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-8. 错误处理"},{slug:"基础笔记-9. 函数",title:"函数",date:x,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-9. 函数"},{slug:"基础笔记-json",title:"json",date:"2017-10-29T11:54:28.000Z",path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-json"},{slug:"基础笔记-namespace、use关键字",title:"namespace和use关键字",date:aW,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-namespace、use关键字"},{slug:"基础笔记-php-替代语法",path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-php-替代语法"},{slug:"基础笔记-twig-date-Zero-padding",title:"twig日期格式化,日期补0问题",date:"2018-04-27T09:30:27.000Z",path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-twig-date-Zero-padding"},{slug:"基础笔记-双冒号和-\u003E",title:"::和-\u003E",date:aW,path:"\u002Fwiki\u002FPHP\u002F基础笔记\u002F基础笔记-双冒号和-\u003E"}],children:[]}]}]}],fetch:{},mutations:aU}}("text","element","\n","code","span","p","token","div","nuxt-content-highlight","pre","line-numbers","language-text","a","true",-1,"icon","icon-link",3,"h3","punctuation"," ","keyword","operator","2017-06-15 10:02","li","\u003E","img",")","(",2,"session","布局文件","关联查询","h2",";","number","配置","请求处理流程","创建","获取请求参数等","响应处理","重定向","文件下载","cookie","视图的创建","传递字典或数组参数","视图的数组安全","视图中显示其他视图（视图组件）","视图之数据块","数据模型","数据库配置","数据模型之活动记录的创建","防止sql注入","查询优化","删除","添加","数据修改","关联查询注意点",",",":","2017-09-07T20:46:52.000Z","nofollow","noopener","noreferrer","_blank","ol","\n    ","-","Yii-Yii学习笔记","Yii学习笔记(一)","控制器controller创建","控制器Controller创建","返回状态码","返回状态码:","可以设置响应头","可以设置响应头:","renderpartial","renderPartial","cookieValidationKey","http:\u002F\u002Fwww.yiichina.com\u002Fdoc\u002Fguide\u002F2.0\u002Fstructure-overview","Yii","需要用到","举例:","使用","common.php","\u003C?=$this-\u003Eblocks['block1'];?\u003E","language-sql","create","database"," yii","\nQuery OK","1","row"," affected "," sec","=","string","http:\u002F\u002Fwww.cnblogs.com\u002Fbeijingstruggle\u002Fp\u002F5885137.html","\u002Fwiki\u002FPHP\u002FYii\u002FYii-Yii学习笔记","2021-09-08T14:11:30.316Z",void 0,"2017-10-15T13:39:37.000Z","2017-09-02T15:53:55.000Z")));