__NUXT_JSONP__("/posts/content/WebViewJavascriptBridge%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT){return {data:[{},{article:{slug:aT,title:aT,date:"2020-05-14 11:32:22 +0800",tags:["源码分析"],categories:["iOS"],series:[],toc:[{id:aU,depth:aC,text:aV},{id:ak,depth:al,text:ak},{id:aW,depth:al,text:aX},{id:am,depth:aC,text:am},{id:an,depth:al,text:an},{id:ao,depth:al,text:ao},{id:ap,depth:aC,text:ap}],body:{type:"root",children:[{type:b,tag:aD,props:{id:aU},children:[{type:b,tag:M,props:{href:"#js-%E7%9B%B8%E5%85%B3%E7%9A%84%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:aV}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:b,tag:M,props:{href:"https:\u002F\u002Fgithub.com\u002Fmarcuswestin\u002FWebViewJavascriptBridge",rel:[aY,aZ,a_],target:a$},children:[{type:a,value:aq}]},{type:a,value:" 是 iOS 开发中常用的类库,用于前端和手机端交互。"}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"这里简单分析其源码，温故而知新。"}]},{type:a,value:k},{type:b,tag:ar,props:{id:ak},children:[{type:b,tag:M,props:{href:"#%E5%89%8D%E7%AB%AF%E8%B0%83%E7%94%A8%E4%BB%A3%E7%A0%81",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:ak}]},{type:a,value:k},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"代码示例见"},{type:b,tag:M,props:{href:"https:\u002F\u002Fgithub.com\u002Fmarcuswestin\u002FWebViewJavascriptBridge\u002Fblob\u002Fmaster\u002FExample%20Apps\u002FExampleApp.html",rel:[aY,aZ,a_],target:a$},children:[{type:a,value:"链接"}]}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,af]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aq}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:ab}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:at}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:ab}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:at}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:at}]}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:ah}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:aE}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"createElement"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"iframe\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"style"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"display"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"none\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bc}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"https:\u002F\u002F__bridge_loaded__\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:aE}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"appendChild"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:be}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:aE}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"removeChild"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aF]},children:[{type:a,value:bf}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n\n"},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"bridge"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" uniqueId "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aF]},children:[{type:a,value:"1"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"registerHandler"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"testJavascriptHandler\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:"\n    responseCallback"}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"ObjC called testJavascriptHandler with\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:" data"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" responseData "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"Javascript Says\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"Right back atcha!\""}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"JS responding with\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"callHandler"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"testObjcCallback\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:" foo"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"bar\""}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"response"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"JS got response\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:" response"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"前端需要引入上述代码,"},{type:b,tag:x,props:{},children:[{type:a,value:"setupWebViewJavascriptBridge(...)"}]},{type:a,value:"会执行以下操作:"}]},{type:a,value:k},{type:b,tag:"ol",props:{},children:[{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"会判断"},{type:b,tag:x,props:{},children:[{type:a,value:bi}]},{type:a,value:"是否存在"}]},{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"如果存在则直接作为参数回调给 function"}]},{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"如果不存在:\n"},{type:b,tag:bj,props:{},children:[{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"将回调 function 存储到"},{type:b,tag:x,props:{},children:[{type:a,value:"window.WVJBCallbacks"}]}]},{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"在 dom 上添加 iframe,并且约定地址为"},{type:b,tag:x,props:{},children:[{type:a,value:"https:\u002F\u002F__bridge_loaded__"}]}]},{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:"原生在 webview 的代理方法中监测到该地址的访问时,会拦截该请求,同时注入 js 代码。执行注入代码时会对"},{type:b,tag:x,props:{},children:[{type:a,value:at}]},{type:a,value:"进行遍历。"}]},{type:a,value:k}]},{type:a,value:k}]},{type:a,value:k}]},{type:a,value:k},{type:b,tag:ar,props:{id:aW},children:[{type:b,tag:M,props:{href:"#webviewjavascriptbridge_jsm-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:aX}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bk}]},{type:a,value:"中首先定义了一个宏:"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,bl]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,bm,bn]},children:[{type:b,tag:c,props:{className:[d,bo]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,bp,l]},children:[{type:a,value:bq}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,br,m]},children:[{type:a,value:"__wvjb_js_func__"}]},{type:b,tag:c,props:{className:[d,bs]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"x"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:" #x"}]}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"宏中包含了一个"},{type:b,tag:x,props:{},children:[{type:a,value:aI}]},{type:a,value:",这种写法专业点叫"},{type:b,tag:x,props:{},children:[{type:a,value:"Stringize"}]},{type:a,value:", 作用是将宏转为字符串常量。例如:"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,bl]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,bm,bn]},children:[{type:b,tag:c,props:{className:[d,bo]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,bp,l]},children:[{type:a,value:bq}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,br,m]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,bs]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"size"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:" #size"}]}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"printf"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bt}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bt}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"使用时虽然定义了很多行，其实字符串是在一行里。因此 js 代码开头和每个语句结尾都需要"},{type:b,tag:x,props:{},children:[{type:a,value:j}]},{type:a,value:" , 用来防止其他行代码的影响。"}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"此文件的 js 代码主要是对"},{type:b,tag:x,props:{},children:[{type:a,value:bi}]},{type:a,value:"进行初始化,以及一些消息逻辑处理。 下面是删减过的一些代码:"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,af]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,S,T]},children:[{type:a,value:ag}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aq}]}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F绑定前端注册消息的方法"}]},{type:a,value:"\n  registerHandler"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" registerHandler"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F绑定前端主动调用app的方法"}]},{type:a,value:"\n  callHandler"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" callHandler"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F`dispatchMessagesWithTimeoutSafety`是否禁用alertbox以加速消息的执行"}]},{type:a,value:"\n  disableJavscriptAlertBoxSafetyTimeout"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" disableJavscriptAlertBoxSafetyTimeout"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F原生端通过此方法获取所有要执行的消息"}]},{type:a,value:"\n  _fetchQueue"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" _fetchQueue"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F原生端主动调用h5时,会触发此方法"}]},{type:a,value:"\n  _handleMessageFromObjC"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" _handleMessageFromObjC"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F 存储app需要执行的消息数组,调用`_doSend`方法时,会在数组中插入一条数据"}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" sendMessageQueue "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F 储存前端注册监听方法。`registerHandler`时会将监听方法进行存储"}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" messageHandlers "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F h5主动去调用原生时,存储一个callbacks,根据以自定义的callbackId作为key。用于处理h5调用原生,然后接收原生返回数据的后的匹配。"}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" responseCallbacks "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"需要注意的是 alert\u002Fprompt\u002Fconfirm 会阻塞消息的执行,因此这里引入了"},{type:b,tag:x,props:{},children:[{type:a,value:"disableJavscriptAlertBoxSafetyTimeout"}]},{type:a,value:"来控制,但如果启用的话,可能影响安全性。"}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"下面看下查看核心的两个方法:"}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:aK}]},{type:a,value:": h5 调用原生或者原生调用 h5,都会触发此方法。 "},{type:b,tag:x,props:{},children:[{type:a,value:aa}]},{type:a,value:"只有在 h5 调用原生时才有值（h5 调用原生才需要回调;h5 接收到原生消息只需要将处理后的消息返回给原生,不需要 callback）。"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,af]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aK}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:ai}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aa},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" callbackId "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"cb_\""}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aj}]},{type:a,value:" uniqueId"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"++"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"_\""}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"new"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"Date"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"getTime"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n    responseCallbacks"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n    message"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n  sendMessageQueue"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n  messagingIframe"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bc}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aL]},children:[{type:a,value:"CUSTOM_PROTOCOL_SCHEME"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\":\u002F\u002F\""}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aL]},children:[{type:a,value:"QUEUE_HAS_MESSAGE"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bw}]},{type:a,value:": 处理原生发来的请求。"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,af]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:bw}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:bx}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"dispatchMessagesWithTimeoutSafety"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:be}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" message "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,"known-class-name",N]},children:[{type:a,value:"JSON"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:"parse"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" messageHandler"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F不为空时,为h5调用原生，然后原生的消息返回"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ac}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F根据消息id,找到h5注册的方法,并进行回调"}]},{type:a,value:"\n      responseCallback "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ac}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ax}]},{type:a,value:aa},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:aH}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002Fjs主动调用原生的回调函数,只让他执行一次即可,不需要长久保存"}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"delete"}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ac}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F此处的代码为原生调用h5的场景"}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:aw}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F原生如果需要h5的处理结果进行回调,则会传递过来callbackId"}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:" callbackResponseId "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:aw}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F定义h5处理结果返回原生的动作"}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,"function-variable",m]},children:[{type:a,value:aa}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:aH}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aK}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n            handlerName"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:"\n            responseId"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:" callbackResponseId"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:"\n            responseData"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F若h5对方法进行了注册`registerHandler`,那么这里可以获取到"}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:J}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:" messageHandlers"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ax}]},{type:a,value:ay},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,bB,N]},children:[{type:a,value:bB}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,L,m,q]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"WebViewJavascriptBridge: WARNING: no handler for message from ObjC:\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:"\n          message\n        "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F对h5注册方法进行回调"}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ay}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:H},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:aD,props:{id:am},children:[{type:b,tag:M,props:{href:"#%E5%8E%9F%E7%94%9F%E4%BB%A3%E7%A0%81%E6%AE%B5",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:am}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"原生代码的处理方法总体来说和 h5 的处理逻辑差不多。"}]},{type:a,value:k},{type:b,tag:ar,props:{id:an},children:[{type:b,tag:M,props:{href:"#%E6%B6%88%E6%81%AF%E6%8B%A6%E6%88%AA",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:an}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"处理的核心就是对自定义消息的拦截:"}]},{type:a,value:k},{type:b,tag:bj,props:{},children:[{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:bC},{type:b,tag:x,props:{},children:[{type:a,value:"__bridge_loaded__"}]},{type:a,value:"请求时,注入"},{type:b,tag:x,props:{},children:[{type:a,value:bk}]},{type:a,value:"中的 js 代码"}]},{type:a,value:k},{type:b,tag:U,props:{},children:[{type:a,value:bC},{type:b,tag:x,props:{},children:[{type:a,value:"__wvjb_queue_message__"}]},{type:a,value:"请求时,获取消息数组("},{type:b,tag:x,props:{},children:[{type:a,value:"WKFlushMessageQueue:"}]},{type:a,value:"),并且依次执行消息("},{type:b,tag:x,props:{},children:[{type:a,value:bD}]},{type:a,value:h}]},{type:a,value:k}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,"language-java"]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:bF},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKWebView"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:bG},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKNavigationAction"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"navigationAction\ndecisionHandler"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aP}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKNavigationActionPolicy"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"decisionHandler "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"webView "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"!="}]},{type:a,value:" _webView"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n    NSURL "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:a,value:"url "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:" navigationAction"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:"request"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:"URL"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n    __strong "},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"typeof"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"_webViewDelegate"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:" strongDelegate "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:" _webViewDelegate"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F思路是拦截iframe的请求"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F 判断是否自己内部定义的url,如__bridge_loaded__ 、__wvjb_queue_message__"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_base isWebViewJavascriptBridgeURL"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_base isBridgeLoadedURL"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F 判断 __bridge_loaded__ 时,注入js。 __bridge_loaded__是前端手动注入的方法。 此时初始化桥js"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_base injectJavascriptFile"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_base isQueueMessageURL"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F当注入的方法执行`_doSend`时,触发 __wvjb_queue_message__"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"self "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKFlushMessageQueue"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_base logUnkownMessage"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aA}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKNavigationActionPolicyCancel"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"strongDelegate "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"&&"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"strongDelegate respondsToSelector"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,"annotation",e]},children:[{type:a,value:"@selector"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bF},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:"decidePolicyForNavigationAction"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"_webViewDelegate webView"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:bG},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:"navigationAction decisionHandler"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aA}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"WKNavigationActionPolicyAllow"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:ar,props:{id:ao},children:[{type:b,tag:M,props:{href:"#%E6%B6%88%E6%81%AF%E6%89%A7%E8%A1%8C",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:ao}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"原生调用 js 就比较简单了,核心代码见"},{type:b,tag:x,props:{},children:[{type:a,value:bD}]},{type:a,value:",此处执行的消息可能有两种类型：一种是原生调用 h5,另一种是 h5 调用原生后的结果的回调。"}]},{type:a,value:k},{type:b,tag:O,props:{className:[P]},children:[{type:b,tag:Q,props:{className:[R,af]},children:[{type:b,tag:x,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"flushMessageQueue"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aQ}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aR}]},{type:a,value:" nil "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"||"}]},{type:a,value:" messageQueueString"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"length"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aR}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aF]},children:[{type:a,value:bf}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,m]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:av}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"WebViewJavascriptBridge: WARNING: ObjC got nil while fetching the message queue JSON from webview. This can happen if the WebViewJavascriptBridge JS is not currently present in the webview, e.g if the webview just loaded a new page.\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"\n\n    id messages "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"self _deserializeMessageJSON"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:"messageQueueString"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:"for"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aS}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"in"}]},{type:a,value:" messages"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"message isKindOfClass"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aS}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,m]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:av}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"WebViewJavascriptBridge: WARNING: Invalid %@ received: %@\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:bK}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"self _log"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"RCVD\""}]},{type:a,value:" json"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        "},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aQ}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:a,value:"responseId "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ac},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F responseId不为空,说明是原生调用h5的回调的响应。"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F直接回调block闭包。 原生调用h5时,会将block存储到中,此处用到就取出来"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:bM}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:" _responseCallbacks"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:ac},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"self"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"responseCallbacks"}]},{type:a,value:" removeObjectForKey"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:ac},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:bM}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,aL]},children:[{type:a,value:"NULL"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aQ}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:a,value:"callbackId "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bP},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aP}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"id responseData"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"responseData "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aR}]},{type:a,value:" nil"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n                        responseData "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:"NSNull"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,bQ,"nil"]},children:[{type:a,value:bQ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F 闭包触发后,将数据返回给h5"}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:aS}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:a,value:"msg "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:"self _queueMessage"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:r}]},{type:a,value:"msg"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aB},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:V}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bP},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aP}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"id ignoreResponseData"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F Do nothing"}]},{type:a,value:aB},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F因为是原生调用h5,因此对应的方法原生应该有注册,并保存到了messageHandlers这里。"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:"WVJBHandler"}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:t}]},{type:a,value:" self"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"messageHandlers"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"handlerName\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:F}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ax}]},{type:a,value:ay},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:aB},{type:b,tag:c,props:{className:[d,m]},children:[{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:av}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"WVJBNoHandlerException, No handler for message from JS: %@\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aB},{type:b,tag:c,props:{className:[d,l,z]},children:[{type:a,value:bK}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"\u002F\u002F触发闭包响应"}]},{type:a,value:E},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:ay}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:u}]},{type:a,value:K},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"\"data\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:D}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:B},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:k}]}]}]},{type:a,value:k},{type:b,tag:aD,props:{id:ap},children:[{type:b,tag:M,props:{href:"#%E6%80%BB%E7%BB%93",ariaHidden:X,tabIndex:Y},children:[{type:b,tag:c,props:{className:[Z,_]},children:[]}]},{type:a,value:ap}]},{type:a,value:k},{type:b,tag:G,props:{},children:[{type:a,value:"整体来说 jsbridge 的代码比较清晰优雅的,很多细节值的学习。"}]}]},dir:"\u002Farticles\u002FiOS",path:"\u002Farticles\u002FiOS\u002FWebViewJavascriptBridge源码分析",extension:".md",createdAt:bS,updatedAt:bS},prev:{slug:"go-learn-3",title:"Go笔记(三)：测试、反射、json解析"},next:{slug:"fastlane+Jenkins自动化部署",title:"fastlane+Jenkins自动化部署iOS项目"},scrollTop:bT}],fetch:{},mutations:bT}}("text","element","span","token","punctuation"," ","operator",")","(",";","\n","keyword","function","{","}",".","property-access",":","\n    ","=","[","]","string","code","\n  ","control-flow","comment","\n        ","maybe-class-name",",","\n            ","if","p","\n      ","message","var","@","method","a","class-name","div","nuxt-content-highlight","pre","line-numbers","dom","variable","li","else","*","true",-1,"icon","icon-link","parameter","responseCallback","return","responseId"," message","\n                    ","language-js","window","WVJBIframe"," responseCallback","+","前端调用代码",3,"原生代码段","消息拦截","消息执行","总结","WebViewJavascriptBridge","h3","callback","WVJBCallbacks","log","NSLog","callbackId","!","handler","url","decisionHandler","\n                ",2,"h2","document","number"," responseData","responseData","#","toString","_doSend","constant","_doDispatchMessageFromObjC","\n          ","void","^","NSString","==","WVJBMessage","WebViewJavascriptBridge源码分析","js-相关的代码分析","js 相关的代码分析","webviewjavascriptbridge_jsm-代码分析","WebViewJavascriptBridge_JS.m 代码分析","nofollow","noopener","noreferrer","_blank","setupWebViewJavascriptBridge","push","src","documentElement","setTimeout","0","\n  bridge","data","window.WebViewJavascriptBridge","ul","WebViewJavascriptBridge_JS.m","language-c","macro","property","directive-hash","directive","define","macro-name","expression","\"good\"","\"callbackId\""," callbackId","_dispatchMessageFromObjC","messageJSON"," responseCallbacks","handlerName"," handler ","console","当触发","flushMessageQueue:","-","webView","webView decidePolicyForNavigationAction","messageQueueString ","message ","class","continue","\"responseId\"","WVJBResponseCallback"," responseCallback ","\"responseData\"","\n                responseCallback ","null"," @","2021-09-15T06:33:58.028Z",void 0)));